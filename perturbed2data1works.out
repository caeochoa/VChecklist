Compressing and copying sample 495
mkdir: cannot create directory ‘/disk/scratch/s2259310’: File exists
mkdir: cannot create directory ‘/disk/scratch/s2259310/nnUNet_raw_data_base’: File exists
mkdir: cannot create directory ‘/disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data’: File exists
mkdir: cannot create directory ‘/disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495’: File exists
Archive:  /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/BraTS2021_00495.zip
Done!
Compressing and copying trained models
Archive:  /disk/scratch/s2259310/models.zip
Done!
Testing PredictPerturb function


Please cite the following paper when using nnUNet:

Isensee, F., Jaeger, P.F., Kohl, S.A.A. et al. "nnU-Net: a self-configuring method for deep learning-based biomedical image segmentation." Nat Methods (2020). https://doi.org/10.1038/s41592-020-01008-z


If you have questions or suggestions, feel free to open an issue at https://github.com/MIC-DKFZ/nnUNet

Image shape is (240, 240, 155)
Patches will have shape (20, 20, 31)
Applying configuration to BraTS2021_00495_0002.nii.gz
Applying the following configuration: {'rr': [[0.5, 1.0]], 'cr': [[0.8, 1.0]], 'or': [[0.0, 0.0]]}
Applying Random Rotation of 90.0º to 50.0% of patches (Size: (20, 20, 31))
['rr', 0, 1.0]
Applying Central Rotation of 90.0º to 80.0% of central patches (Size: (20, 20, 31))
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/rr-50-1
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/cr-80-1
Image shape is (240, 240, 155)
Patches will have shape (20, 20, 31)
Applying configuration to BraTS2021_00495_0000.nii.gz
Applying the following configuration: {'rr': [[0.5, 1.0]], 'cr': [[0.8, 1.0]], 'or': [[0.0, 0.0]]}
Applying Random Rotation of 90.0º to 50.0% of patches (Size: (20, 20, 31))
['rr', 0, 1.0]
Applying Central Rotation of 90.0º to 80.0% of central patches (Size: (20, 20, 31))
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/rr-50-1
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/cr-80-1
Directory already exists
Image shape is (240, 240, 155)
Patches will have shape (20, 20, 31)
Applying configuration to BraTS2021_00495_0001.nii.gz
Applying the following configuration: {'rr': [[0.5, 1.0]], 'cr': [[0.8, 1.0]], 'or': [[0.0, 0.0]]}
Applying Random Rotation of 90.0º to 50.0% of patches (Size: (20, 20, 31))
['rr', 0, 1.0]
Applying Central Rotation of 90.0º to 80.0% of central patches (Size: (20, 20, 31))
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/rr-50-1
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/cr-80-1
Directory already exists
Image shape is (240, 240, 155)
Patches will have shape (20, 20, 31)
Applying configuration to BraTS2021_00495_0003.nii.gz
Applying the following configuration: {'rr': [[0.5, 1.0]], 'cr': [[0.8, 1.0]], 'or': [[0.0, 0.0]]}
Applying Random Rotation of 90.0º to 50.0% of patches (Size: (20, 20, 31))
['rr', 0, 1.0]
Applying Central Rotation of 90.0º to 80.0% of central patches (Size: (20, 20, 31))
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/rr-50-1
Directory already exists
Creating directory /disk/scratch/s2259310/nnUNet_raw_data_base/nnUNet_raw_data/Task501_BraTS2021495/perturbed/cr-80-1
Directory already exists
This model expects 4 input modalities for each image
Found 1 unique case ids, here are some examples: ['BraTS2021_00495']
If they don't look right, make sure to double check your filenames. They must end with _0000.nii.gz etc
emptying cuda cache
loading parameters for folds, None
folds is None so we will automatically look for output folders (not using 'all'!)
found the following folds:  ['/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_0', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_1', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_2', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_3', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_4']
using the following model files:  ['/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_0/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_1/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_2/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_3/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_4/model_final_checkpoint.model']
starting preprocessing generator
starting prediction...
preprocessing /disk/scratch/s2259310/outputs/PredictPerturbTest/perturbed/cr-80-1/BraTS2021_00495.nii.gz
using preprocessor GenericPreprocessor
before crop: (4, 155, 240, 240) after crop: (4, 137, 174, 133) spacing: [1. 1. 1.] 

no resampling necessary
no resampling necessary
before: {'spacing': array([1., 1., 1.]), 'spacing_transposed': array([1., 1., 1.]), 'data.shape (data is transposed)': (4, 137, 174, 133)} 
after:  {'spacing': array([1., 1., 1.]), 'data.shape (data is resampled)': (4, 137, 174, 133)} 

(4, 137, 174, 133)
This worker has ended successfully, no errors to report
force_separate_z: None interpolation order: 1
no resampling necessary
predicting /disk/scratch/s2259310/outputs/PredictPerturbTest/perturbed/cr-80-1/BraTS2021_00495.nii.gz
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 174, 133)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 46], [0, 5]]
number of tiles: 8
computing Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 174, 133)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 46], [0, 5]]
number of tiles: 8
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 174, 133)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 46], [0, 5]]
number of tiles: 8
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 174, 133)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 46], [0, 5]]
number of tiles: 8
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 174, 133)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 46], [0, 5]]
number of tiles: 8
using precomputed Gaussian
prediction done
inference done. Now waiting for the segmentation export to finish...
postprocessing...
This model expects 4 input modalities for each image
Found 1 unique case ids, here are some examples: ['BraTS2021_00495']
If they don't look right, make sure to double check your filenames. They must end with _0000.nii.gz etc
emptying cuda cache
loading parameters for folds, None
folds is None so we will automatically look for output folders (not using 'all'!)
found the following folds:  ['/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_0', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_1', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_2', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_3', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_4']
using the following model files:  ['/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_0/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_1/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_2/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_3/model_final_checkpoint.model', '/disk/scratch/s2259310/nnUNet_trained_models/nnUNet/3d_fullres/Task001_BrainTumour/nnUNetTrainerV2__nnUNetPlansv2.1/fold_4/model_final_checkpoint.model']
starting preprocessing generator
starting prediction...
preprocessing /disk/scratch/s2259310/outputs/PredictPerturbTest/perturbed/rr-50-1/BraTS2021_00495.nii.gz
using preprocessor GenericPreprocessor
before crop: (4, 155, 240, 240) after crop: (4, 137, 200, 160) spacing: [1. 1. 1.] 

no resampling necessary
no resampling necessary
before: {'spacing': array([1., 1., 1.]), 'spacing_transposed': array([1., 1., 1.]), 'data.shape (data is transposed)': (4, 137, 200, 160)} 
after:  {'spacing': array([1., 1., 1.]), 'data.shape (data is resampled)': (4, 137, 200, 160)} 

(4, 137, 200, 160)
This worker has ended successfully, no errors to report
force_separate_z: None interpolation order: 1
no resampling necessary
predicting /disk/scratch/s2259310/outputs/PredictPerturbTest/perturbed/rr-50-1/BraTS2021_00495.nii.gz
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 200, 160)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 36, 72], [0, 32]]
number of tiles: 12
computing Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 200, 160)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 36, 72], [0, 32]]
number of tiles: 12
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 200, 160)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 36, 72], [0, 32]]
number of tiles: 12
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 200, 160)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 36, 72], [0, 32]]
number of tiles: 12
using precomputed Gaussian
prediction done
debug: mirroring 1 mirror_axes (0, 1, 2)
step_size: 0.5
do mirror: 1
data shape: (4, 137, 200, 160)
patch size: [128 128 128]
steps (x, y, and z): [[0, 9], [0, 36, 72], [0, 32]]
number of tiles: 12
using precomputed Gaussian
prediction done
inference done. Now waiting for the segmentation export to finish...
postprocessing...
PredictPerturbTest worked!
All done!
